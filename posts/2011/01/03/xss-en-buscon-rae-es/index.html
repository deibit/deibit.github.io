<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="es">
<head>
<meta charset="utf-8">
<base href="http://deibit.com/posts/2011/01/03/xss-en-buscon-rae-es/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>XSS en buscon.rae.es | deibit</title>
<link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">
<link rel="canonical" href="http://deibit.com/posts/2011/01/03/xss-en-buscon-rae-es/">
<!--[if lt IE 9]><script src="../../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="David García">
<link rel="prev" href="../../../../2010/12/18/anadir-librerias-nativas-en-netbeans/" title="Añadir librerías nativas en NetBeans" type="text/html">
<link rel="next" href="../../12/copiar-de-la-linea-de-comandos-al-portapapeles/" title="Copiar de la linea de comandos al portapapeles" type="text/html">
<meta property="og:site_name" content="deibit">
<meta property="og:title" content="XSS en buscon.rae.es">
<meta property="og:url" content="http://deibit.com/posts/2011/01/03/xss-en-buscon-rae-es/">
<meta property="og:description" content="Vía un amigo me han pasado un XSS bastante cachondo. Ignoro si la masa mediática ha pasado por encima de él pero huele a carnaza ripia. Sin más:



No, no han “atacado” el servidor ni lo han “defacead">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2011-01-03T21:28:19+01:00">
<meta property="article:tag" content="Analysis">
<meta property="article:tag" content="seguridad">
<meta property="article:tag" content="vulnerabilidad">
<meta property="article:tag" content="xss">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://deibit.com/">

                <span id="blog-title">deibit</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../../../archive.html">Archivo</a>
                </li>
<li>
<a href="../../../../../categories/">Etiquetas</a>
                </li>
<li>
<a href="../../../../../rss.xml">Canal RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.src.html" id="sourcelink">Código fuente</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">XSS en buscon.rae.es</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    David García
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2011-01-03T21:28:19+01:00" itemprop="datePublished" title="2011-01-03 21:28">2011-01-03 21:28</time></a></p>
            
        <p class="sourceline"><a href="index.src.html" id="sourcelink">Código fuente</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Vía un amigo me han pasado un XSS bastante cachondo. Ignoro si la masa mediática ha pasado por encima de él pero huele a carnaza ripia. Sin más:<br><br><br><a href="http://daganu.files.wordpress.com/2011/01/xss1.png"><img src="http://daganu.files.wordpress.com/2011/01/xss1.png?w=300" alt="" title="xss1" width="300" height="179" class="aligncenter size-medium wp-image-115"></a><br><br><br>
No, no han “atacado” el servidor ni lo han “defaceado”. Se trata de un XSS no persistente que inyecta en un marco HTML procedente de un servidor externo, cuyo código usa como hojas de estilo (CSS) las propias del sitio de la rae para darle “autenticidad”.<br><br><br>
Captura del resultado de dos tipos de peticiones, arriba una petición sin payload y abajo la que si lo lleva.<br><br><br><a href="http://daganu.files.wordpress.com/2011/01/xss3.png"><img src="http://daganu.files.wordpress.com/2011/01/xss3.png?w=300" alt="" title="xss3" width="300" height="173" class="aligncenter size-medium wp-image-116"></a><br><br><br>
Poco que añadir. El parámetro ‘LEMA’ no es filtrado adecuadamente (¿se quedaron sólo en &amp;tl &amp;gt?) y en la petición con payload puede verse como se hace uso del DOM para modificar la propiedad ‘location’ de un formulario incrustando HTML externo desde el dominio http://leysinde.110mb.com. Un hosting gratuito.<br><br><br>
El código incrustado, ya por curiosidad:<br><br><br><a href="http://daganu.files.wordpress.com/2011/01/xss2.png"><img src="http://daganu.files.wordpress.com/2011/01/xss2.png?w=300" alt="" title="xss2" width="300" height="179" class="aligncenter size-medium wp-image-118"></a><br><br><br>
Me llamó la atención el .js http://cdn.viglink.com/api/vglnk.js lo interpreta y sale. Si ves el código desde el navegador no verás nada. Pero si tiras de wget no lo interpreta y:<br><br><br><a href="http://daganu.files.wordpress.com/2011/01/xss4.jpg"><img src="http://daganu.files.wordpress.com/2011/01/xss4.jpg?w=300" alt="" title="xss4" width="300" height="288" class="aligncenter size-medium wp-image-119"></a><br><br><br>
Es un script que te mete 110mb.com para echarle un ojo a los números de tu sitio :D ¡Menuda desilusión!</p>

    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../../categories/analysis/" rel="tag">Analysis</a></li>
            <li><a class="tag p-category" href="../../../../../categories/seguridad/" rel="tag">seguridad</a></li>
            <li><a class="tag p-category" href="../../../../../categories/vulnerabilidad/" rel="tag">vulnerabilidad</a></li>
            <li><a class="tag p-category" href="../../../../../categories/xss/" rel="tag">xss</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../../../2010/12/18/anadir-librerias-nativas-en-netbeans/" rel="prev" title="Añadir librerías nativas en NetBeans">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../../12/copiar-de-la-linea-de-comandos-al-portapapeles/" rel="next" title="Copiar de la linea de comandos al portapapeles">Siguiente publicación</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:daganu@gmail.com">David García</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script><script src="../../../../../assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
