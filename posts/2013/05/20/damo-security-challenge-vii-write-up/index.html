<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="http://deibit.com/posts/2013/05/20/damo-security-challenge-vii-write-up/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Damo Security Challenge VII - Write Up | deibit</title>
<link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">
<link rel="canonical" href="http://deibit.com/posts/2013/05/20/damo-security-challenge-vii-write-up/">
<link rel="icon" href="../../../../../favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="../../../../../assets/js/html5.js"></script><![endif]--><style>
#barraaceptacion {
    display:none;
    position:fixed;
    left:0px;
    right:0px;
    bottom:0px;
    padding-bottom:55px;
    width:100%;
    text-align:center;
    min-height:40px;
    background-color: rgba(0, 0, 0, 0.5);
    color:#fff;
    z-index:99999;
}

.inner {
    width:100%;
    position:absolute;
    padding-left:5px;
    font-family:verdana;
    font-size:12px;
    top:30%;
}

.inner a.ok {
    padding:4px;
    color:#00ff2e;
    text-decoration:none;
}

.inner a.info {
    padding-left:5px;
    text-decoration:none;
    color:#faff00;
}
</style>
<meta name="author" content="David García">
<link rel="prev" href="../../12/damo-security-challenge-vi-write-up/" title="Damo Security Challenge VI - Write Up" type="text/html">
<link rel="next" href="../damo-security-challenge-viii-write-up/" title="Damo Security Challenge VIII - Write Up" type="text/html">
<meta property="og:site_name" content="deibit">
<meta property="og:title" content="Damo Security Challenge VII - Write Up">
<meta property="og:url" content="http://deibit.com/posts/2013/05/20/damo-security-challenge-vii-write-up/">
<meta property="og:description" content="Another write up on Damo’s Challenges. This time was the turn for VII and the topic was on WiFi caps. Really fun.
All we got are some packets captured by a guy. A packet capture and some csv files fro">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2013-05-20T14:00:53+02:00">
<meta property="article:tag" content="challenge">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="wep">
<meta property="article:tag" content="wifi">
<meta property="article:tag" content="writeup">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://deibit.com/">

                <span id="blog-title">deibit</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../../../archive.html">Archive</a>
                </li>
<li>
<a href="../../../../../categories/">Tags</a>
                </li>
<li>
<a href="../../../../../rss.xml">RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.src.html" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Damo Security Challenge VII - Write Up</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    David García
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2013-05-20T14:00:53+02:00" itemprop="datePublished" title="2013-05-20 14:00">2013-05-20 14:00</time></a></p>
            
        <p class="sourceline"><a href="index.src.html" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Another write up on Damo’s Challenges. This time was the turn for VII and the topic was on WiFi caps. Really fun.</p>
<p>All we got are some packets captured by a guy. A packet capture and some csv files from kismet, etc. We need to decrypt the packets to get the “conversation” in clear text. So we need the WEP key.</p>
<p>If we try to use aircrack-ng with the capture it will say that the IV (initialization vector) are insufficient in number. So, how are we gonna manage to get the key?…The used router was an Eircom one. Googling it the results says some of them contains a weak algorithm when they make the default WEP key. In one of the csv files you can see the SSID of the router: “Eircom1234 5670″. Putting it in<a href="http://www.bacik.ie/eircomwep/"> this online key generator </a>brings us some WEP keys.</p>
<table class=" aligncenter" border="0" cellpadding="10"><tbody>
<tr>
<td>WEP Key 1</td>
<td>1809d03b82b17d47d8195be596</td>
</tr>
<tr>
<td>WEP Key 2</td>
<td>3e4e9dd68d42d47fb87b89cbc1</td>
</tr>
<tr>
<td>WEP Key 3</td>
<td>fd2e8feb1d511e4e1db9f6d98e</td>
</tr>
<tr>
<td>WEP Key 3</td>
<td>7181fdcaca488e991ed90bb124</td>
</tr>
</tbody></table>
<p>Using airdecap-ng with the key on the capture file output the decrypted version of the file:</p>
<p><a href="http://daganu.files.wordpress.com/2013/05/2013-05-20-071321-00001.png"><img class="aligncenter size-medium wp-image-677" alt="2013-05-20 07:13:21 +00001" src="http://daganu.files.wordpress.com/2013/05/2013-05-20-071321-00001.png?w=300" width="300" height="178"></a></p>
<p>And opening the file with wireshark shows a nice view of the capture.</p>
<p>damo.clanteam.com resolves to 67.220.217.235, filtering by this IP in Wireshark…</p>
<p><a href="http://daganu.files.wordpress.com/2013/05/2013-05-20-072136-00001.png"><img class="aligncenter size-medium wp-image-678" alt="2013-05-20 07:21:36 +00001" src="http://daganu.files.wordpress.com/2013/05/2013-05-20-072136-00001.png?w=300" width="300" height="178"></a></p>
<p>Looking for the right request we can see the Basic Authentication token and just by decoding it (base64):</p>
<p>YWRtaW46eDRnaDlpMTA= -&gt; admin:x4gh9i10</p>
<p>We got the user/pass. The url to go is in the capture too:</p>
<p>damo.clanteam.com/sch7/updatehof</p>
<p>That’s all. We are done.</p>

    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../../categories/challenge/" rel="tag">challenge</a></li>
            <li><a class="tag p-category" href="../../../../../categories/ctf/" rel="tag">ctf</a></li>
            <li><a class="tag p-category" href="../../../../../categories/wep/" rel="tag">wep</a></li>
            <li><a class="tag p-category" href="../../../../../categories/wifi/" rel="tag">wifi</a></li>
            <li><a class="tag p-category" href="../../../../../categories/writeup/" rel="tag">writeup</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../12/damo-security-challenge-vi-write-up/" rel="prev" title="Damo Security Challenge VI - Write Up">Previous post</a>
            </li>
            <li class="next">
                <a href="../damo-security-challenge-viii-write-up/" rel="next" title="Damo Security Challenge VIII - Write Up">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:daganu@gmail.com">David García</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
        </footer>
</div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><!--//BLOQUE COOKIES--><div id="barraaceptacion" style="display: block;">
    <div class="inner">
        Solicitamos su permiso para obtener datos estadísticos de su navegación en esta web, en cumplimiento del Real
        Decreto-ley 13/2012. Si continúa navegando consideramos que acepta el uso de cookies.
        <a href="javascript:void(0);" class="ok" onclick="PonerCookie();"><b>OK</b></a> |
        <a href="http://politicadecookies.com" target="_blank" class="info">Más información</a>
    </div>
</div>
<!--//FIN BLOQUE COOKIES-->
<script>
function getCookie(c_name){
    var c_value = document.cookie;
    var c_start = c_value.indexOf(" " + c_name + "=");
    if (c_start == -1){
        c_start = c_value.indexOf(c_name + "=");
    }
    if (c_start == -1){
        c_value = null;
    }else{
        c_start = c_value.indexOf("=", c_start) + 1;
        var c_end = c_value.indexOf(";", c_start);
        if (c_end == -1){
            c_end = c_value.length;
        }
        c_value = unescape(c_value.substring(c_start,c_end));
    }
    return c_value;
}

function setCookie(c_name,value,exdays){
    var exdate=new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
    document.cookie=c_name + "=" + c_value;
}

if(getCookie('avisocookies')!="1"){
    document.getElementById("barraaceptacion").style.display="block";
}
function PonerCookie(){
    setCookie('avisocookies','1',365);
    document.getElementById("barraaceptacion").style.display="none";
}
</script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-81129845-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
