<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="es">
<head>
<meta charset="utf-8">
<base href="http://deibit.com/posts/2013/05/20/damo-security-challenge-viii-write-up/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Damo Security Challenge VIII - Write Up | deibit</title>
<link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">
<link rel="canonical" href="http://deibit.com/posts/2013/05/20/damo-security-challenge-viii-write-up/">
<!--[if lt IE 9]><script src="../../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="David García">
<link rel="prev" href="../damo-security-challenge-vii-write-up/" title="Damo Security Challenge VII - Write Up" type="text/html">
<meta property="og:site_name" content="deibit">
<meta property="og:title" content="Damo Security Challenge VIII - Write Up">
<meta property="og:url" content="http://deibit.com/posts/2013/05/20/damo-security-challenge-viii-write-up/">
<meta property="og:description" content="Well, the (at this time) final challenge of Damo series. A really cool one. I expected it would take me much more time but I must have been lucky solving it.
This time we have to show our RE skills, m">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2013-05-20T14:58:38+02:00">
<meta property="article:tag" content="challenge">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="decompiler">
<meta property="article:tag" content="java">
<meta property="article:tag" content="writeup">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://deibit.com/">

                <span id="blog-title">deibit</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../../../archive.html">Archivo</a>
                </li>
<li>
<a href="../../../../../categories/">Etiquetas</a>
                </li>
<li>
<a href="../../../../../rss.xml">Canal RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.src.html" id="sourcelink">Código fuente</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Damo Security Challenge VIII - Write Up</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    David García
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2013-05-20T14:58:38+02:00" itemprop="datePublished" title="2013-05-20 14:58">2013-05-20 14:58</time></a></p>
            
        <p class="sourceline"><a href="index.src.html" id="sourcelink">Código fuente</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Well, the (at this time) final challenge of Damo series. A really cool one. I expected it would take me much more time but I must have been lucky solving it.</p>
<p>This time we have to show our RE skills, more accurately on Java apps. Ok, we just download the zip that contains the GovermentFileStore.jar</p>
<p>If we execute the app it shows a modal window asking for a username / password. I put it through a http-proxy (Burp) and sniffing all network activity with Wireshark but there weren’t activity at all. I put a wrong combination, failed of course but any network traffic…Ok, username and password are checked at home.</p>
<p>By using a decompiler we target the custom package: com.security.challenge.eight, just wandering along the code the username/password arises:</p>
<p><a href="http://daganu.files.wordpress.com/2013/05/2013-05-20-111301-00001.png"><img class="aligncenter size-medium wp-image-682" alt="2013-05-20 11:13:01 +00001" src="http://daganu.files.wordpress.com/2013/05/2013-05-20-111301-00001.png?w=300" width="300" height="230"></a></p>
<p>Now we can upload files.I did some tries uploading little custom php shells (you know, the system($_GET['cmd']…) but it didn’t feel the way to go. Some of the advices at the challenge page says “flaws in the application”. Ok let’s change the strategy.</p>
<p>From the captured traffic at Burp, our requests to the upload script uses a Basic Authentication coded string:</p>
<p><a href="http://daganu.files.wordpress.com/2013/05/2013-05-20-134505-00001.png"><img class="aligncenter size-medium wp-image-683" alt="2013-05-20 13:45:05 +00001" src="http://daganu.files.wordpress.com/2013/05/2013-05-20-134505-00001.png?w=300" width="300" height="101"></a></p>
<p>From the request we take the Basic Authentication value:</p>
<p>Host: damo.clanteam.com<br><strong>Authorization: Basic YWRtaW5pc3RyYXRvcjphZGYwODkyM2RoZGZzZGZnNzQ1a2x4</strong><br>
Accept: */*<br>
Accept-Language: en<br>
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)<br>
Connection: close</p>
<p>When we decoded it (base64) results in:</p>
<p>administrator:adf08923dhdfsdfg745klx</p>
<p>Now we can tinker with it in the browser at the file_upload folder:</p>
<p><img class="aligncenter size-medium wp-image-684" alt="2013-05-20 13:19:18 +00001" src="http://daganu.files.wordpress.com/2013/05/2013-05-20-131918-00001.png?w=300" width="300" height="191"></p>
<p>Besides other contestants stuff the admin’s file is there. What? ok, the older one and the first from the list.</p>
<p>Now if we try to uncompress the file (a Zip format) it ask for a password.</p>
<p>When we upload the file it seems to be already compressed (pay attention at the PK signature of the second screenshot) so the application is compressing and cyphering the zip. Additionally the package of the decompiled Java net.lingala.zip4j confirms all.</p>
<p>Well, again, looking at the code it looked clear:</p>
<p><a href="http://daganu.files.wordpress.com/2013/05/2013-05-20-132656-00001.png"><img class="aligncenter size-medium wp-image-685" alt="2013-05-20 13:26:56 +00001" src="http://daganu.files.wordpress.com/2013/05/2013-05-20-132656-00001.png?w=300" width="300" height="37"></a></p>
<p>If the original filename was: <em>memo_to_hof_admin.txt</em> We only need to know the SHA1 hash of the filename (Python):</p>
<p>&gt;&gt;&gt; hashlib.sha1(“memo_to_hof_admin.txt”).hexdigest()<br>
’293b663b729409237c28c2ff5659b0ba22caf50b’</p>
<p>Uncompressing the zip gives us a txt file with the following content:</p>
<p><a href="http://daganu.files.wordpress.com/2013/05/2013-05-20-135525-00001.png"><img class="aligncenter size-medium wp-image-686" alt="2013-05-20 13:55:25 +00001" src="http://daganu.files.wordpress.com/2013/05/2013-05-20-135525-00001.png?w=300" width="300" height="139"></a></p>
<p>And that’s all! We are done.</p>
<p>Kudos to <a href="http://damo.clanteam.com/">damo</a> for the challenges, it was a pleasure to play with them.</p>

    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../../categories/challenge/" rel="tag">challenge</a></li>
            <li><a class="tag p-category" href="../../../../../categories/ctf/" rel="tag">ctf</a></li>
            <li><a class="tag p-category" href="../../../../../categories/decompiler/" rel="tag">decompiler</a></li>
            <li><a class="tag p-category" href="../../../../../categories/java/" rel="tag">java</a></li>
            <li><a class="tag p-category" href="../../../../../categories/writeup/" rel="tag">writeup</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../damo-security-challenge-vii-write-up/" rel="prev" title="Damo Security Challenge VII - Write Up">Publicación anterior</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:daganu@gmail.com">David García</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script><script src="../../../../../assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
